---
title: "6:59:38 PM - October 22, 2025"
date: 2025-10-22T05:59:38.905Z
timestamp: 1761112778905
---

## Project Notes

## OpenVine Drift Migration Analysis

**Current State**: Fragmented caching with manual refresh patterns
- 9 services using Hive (profile_cache, personal_event_cache, etc.)
- Manual Timer-based polling in providers (10 minutes for home feed)
- Manual listeners on ChangeNotifier services
- Duplicate cache layers (memory + Hive + service layer)

**Discovery**: nostr_sdk uses sqflite (NOT Rust!)
- Database at `{appDocs}/openvine/database/local_relay.db`
- Schema version 2, single `event` table
- Drift can open SAME database and add tables at schema version 3+

**Riverpod Pattern Changes**:
1. home_feed_provider: AsyncNotifier (80 lines timers) → StreamProvider (25 lines)
2. video_events_provider: Manual StreamController → Drift stream
3. user_profile_providers: Manual cache → Database IS cache

**Benefits**:
- Automatic reactivity (no timers, no manual invalidation)
- Single source of truth (all events in DB)
- Code reduction: ~500 lines of timer/cache/listener code eliminated
- Performance: 10min polling → instant updates

**TDD Plan Created**: TDD_IMPLEMENTATION_PLAN.md
- 4-phase migration (Infrastructure, Riverpod, Event Router, Migration)
- Test coverage: unit, integration, platform, performance
- Risk mitigation: feature flags, rollback, side-by-side testing

